<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
</head>
<div class="container border pb-3 shadow-sm p-3 mb-5 bg-body-tertiary rounded" style="margin-top: 30px;">
  <h1>Sign In to Continue</h1>
  <div class="container">
    <div class="container">
    </div>
    <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon1">Email</span>
      <input id="Email" type="text" class="form-control row-6" placeholder="Email" aria-label="Username"
        aria-describedby="basic-addon1" />
    </div>
  </div>
  <div class="container">
    <div class="input-group mb-3">
      <span class="input-group-text" id="basic-addon1">Password</span>
      <input id="Pass" type="password" class="form-control row-6" placeholder="Password" aria-label="Username"
        aria-describedby="basic-addon1" />
    </div>
    <h5 id="e"></h5>
  </div>

  <button id="log" class="btn btn-primary">Login</button>
  <button id="go" class="btn btn-secondary">Go to SignUp</button>
</div>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import {
    signInWithEmailAndPassword,
    getAuth,
    onAuthStateChanged,
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import {
    getDatabase,
    ref,
    onValue,
    get,
    child,
  } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyB5CBskeDYo_DpeskcP7B4K0qKwuGvtnn0",
    authDomain: "foodpsykes.firebaseapp.com",
    projectId: "foodpsykes",
    storageBucket: "foodpsykes.appspot.com",
    messagingSenderId: "429664914347",
    appId: "1:429664914347:web:6d1e41cf493d55561de0ee",
    measurementId: "G-86M6HF41TQ",
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);

  const auth = getAuth(app);
  const database = getDatabase(app);

  const buttonLogin = document.getElementById("log");

  function alert() {
    console.log("hello");
  }

  console.log(buttonLogin);
  const go = document.getElementById('go');

  go.addEventListener('click', () => {
    window.location.href = 'http://127.0.0.1:5500/code/SignUp.html'
  })

  // go.addEventListener("click",()=>{
  //   window.location.href='SignUp.html'
  // })
  buttonLogin.addEventListener("click", async () => {
    console.log("Click");
    const userPassword = document.getElementById("Email").value;
    const userEmail = document.getElementById("Pass").value;
    signInWithEmailAndPassword(auth, userPassword, userEmail)
      .then((userCredential) => {
        const user = userCredential.user;
        alert('login successfully');
      })
      .catch((error) => {
        console.error('error', error.message);
      });
  }
  );
  onAuthStateChanged(auth, (user) => {
    console.log(user);
    if (user?.email) {
      window.location.href = "http://127.0.0.1:5500/code/profile.html";
    } else {
      console.log("Chưa đăng nhập");

    }
  });
  //   onAuthStateChanged(auth,(user))
</script>
</body>

</html>